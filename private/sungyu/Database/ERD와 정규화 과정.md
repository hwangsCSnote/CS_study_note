# ERD와 정규화 과정

### ERD(Entity Relationship Diagram, 개체-관계 다이어그램)
: 데이터베이스를 설계할 때 데이터의 개체(Entity)와 개체들 간 관계(Relationship)를 시각적으로 표현하는 모델링 기법이다.

- **데이터 모델링 과정**을 이해하면 ERD가 어느 단계에 사용되고 활용되는지 깊이있게 이해할 수 있다.

<br>

**데이터 모델링**이란?  
: 구축하고자 하는 시스템의 **업무 내용을 분석**하여 이해하고, **약속된 표기법으로 표현**하는 것.  

- 데이터를 추상화하여 표기하기 때문에 데이터베이스의 **전체적인 골격/구조를 이해하기 수월**하다.
- 그 이해를 바탕으로 **기능/성능면에서 효율적인 SQL 문장을 작성**할 수 있다.
- 때문에 데이터 모델링은 **데이터베이스 설계 과정의 핵심 과정**이다.  

<br>

**데이터 모델링 순서/절차**
1. **업무 파악 (요구사항 수집 및 분석)**  
> 어떤 업무를 데이터베이스화 하여 모델링 할 것인지 요구사항을 수집하는 과정

- 업무 파악에 가장 좋은 예시는 **UI 또는 시각적 자료를 의뢰인/기획자 와 함께 확인**하며 나아가는 것이다.  
  또한 궁극적인 목표에 대해 심도있게 이해하는 과정이 필요하다.

  ex) FinishLine Project Refactoring 과정 (전공 데이터, 하드코딩 → 테이블 생성)
  
  <img width="308" height="477" alt="스크린샷 2026-01-05 09 21 12" src="https://github.com/user-attachments/assets/3e46329f-0f21-4140-b83c-ff81820d90ad" />
  <img width="360" height="477" alt="스크린샷 2026-01-05 09 22 53" src="https://github.com/user-attachments/assets/dc5c6387-12dc-4d65-adff-c380248340d4" />  


2. **개념적 데이터 모델링**
> 하고자 하는 업무와 데이터 간 관계를 구상하는 단계로, 각 개체(Entity)들과 그들 간의 관계를 발견하고  
> 표현하기 위해 ERD를 생성한다.  

- ERD 표기법에는 E-R 모델을 제안한 **피터 첸 표기법**(Peter Chen Notation)이 가장 기본적이다.  
- 추가로 **정보 공학 표기법**(IE Notation), **바커 표기법**(Barker Notation) 등의 방법이 있고,  
  실무에서는 보통 **정보 공학 표기법**(IE Notation, IE 표기법)을 많이 사용한다고 한다.

  <img width="356" height="233" alt="image" src="https://github.com/user-attachments/assets/1976c368-ad52-4db7-9a98-eb64bc00baf9" />
  <img width="341" height="227" alt="image 2" src="https://github.com/user-attachments/assets/9ab2b2d7-2e83-4729-9b73-c1e18289a4c6" />


3. **논리적 데이터 모델링**
> 개념적 데이터 모델링 이후, 구체적인 업무를 중심으로 데이터 모델을 만들어내는데  
> 해당 과정을 논리적 데이터 모델링이라고 한다.  

- 해당 단계에서는 **Key**, **속성**, **관계** 등을 표시하며, **정규화** 과정을 수행한다.  
- 앞서 피터 첸 표기법으로 작성한 개념적 ERD를 구체화하여 **정보 공학 표기법**(IE Notation)의 
  테이블 형태로 재구성한다.
- 추상적인 데이터에서 보다 구체적으로 작성하고, 각 속성에 **데이터 타입**을 명시한다.
- 또한 **데이터 간 관계**를 정밀하게 맺어주며, **테이블의 키(Key)를 지정**해준다.

  <img width="804" height="688" alt="ERD - IE Notation" src="https://github.com/user-attachments/assets/3ab84eb2-76e0-4d47-b231-028db25ccb72" />


4. **물리적 데이터 모델링**
> 최종적으로 데이터를 관리할 DBMS를 선택하고, 선택한 데이터베이스에 실제 테이블을 만드는 단계이다.

  <img width="611" height="191" alt="스크린샷 2026-01-05 11 30 28" src="https://github.com/user-attachments/assets/78c74c91-cb70-4e20-ac86-6619253f5dbd" />

<br>
<br>

### 예제로 배우는 ERD

- **엔터티**(Entity)

| 전공(major) |
|:---------:|
|           |


- **엔터티 속성**(Attribute)

| 전공(major) |
|:---------:|
| 전공코드      |
| 전공명       |
| 단과 대학     |
| 전공 분류     |


- **엔터티 도메인**(Domain)

| 전공    | (major)      |
|------:|--------------|
| 전공코드  | VARCHAR(100) |
| 전공명   | VARCHAR(100) |
| 단과 대학 | VARCHAR(100) |
| 전공 분류 | VARCHAR(30)  |


- **키**(Key) + **제약 조건**  
: 기본키/외래키에는 속성명에 🔑 표시, NULL을 허용하지 않을 경우 **N** 표시

**< MajorMap >**  

| 전공      | (major)             |
|--------:|---------------------|
| 🔑  전공코드 | VARCHAR(100)  **N** |
| 전공명     | VARCHAR(100)  **N** |
| 단과 대학   | VARCHAR(100)        |
| 전공 분류   | VARCHAR(30)         |

**< User >**  

| 학생      | (user)             |
|--------:|--------------------|
| 🔑  학번   | VARCHAR(30)  **N** |
| 이름      | VARCHAR(50)  **N** |
| 🔑  전공코드 | VARCHAR(100) **N** |
| …       | …                  |

<br>
<br>

### 정규화(DB Normalization)  
: 데이터베이스에서 데이터의 중복을 최소화하고, 데이터의 일관성과 무결성을 유지하기 위해 데이터를  
여러 테이블로 분리하는 과정

- 데이터 **이상 현상(삽입 이상, 갱신 이상, 삭제 이상)을 줄이기 위한** 데이터베이스 설계 기법  
- 엔터티를 상세화 하는 과정으로 **논리 데이터 모델링 시점**에 고려된다.  
- 데이터의 중복을 제거하고 데이터 모델의 독립성을 확보  
- 제 1정규화부터 5정규화까지 존재하지만, 실질적으로 제 3정규화까지만 수행  

ex)  
현재 FinishLine 서비스 user 테이블(회원 엔터티)을 보면 `회원 + 학점 엔터티`를 합쳐 놓은 형태이다.  
따라서 회원명, 학번, 전공, 전공 이수학점, 교양 이수학점 등의 속성이 존재하는데,  
새로운 회원값이 추가될 때 정해지지 않은 학점정보(전공 이수학점, 교양 이수학점, 부족학점, 총 학점 등)  
모두 임의값 또는 NULL이 삽입되어야 한다.  

<br>

**제 1 정규화**(1NF)
> 테이블의 컬럼이 **원자성**(한 속성이 하나의 값을 갖는 특성)을 갖도록 테이블을 분해하는 단계  

- **기존**  
**< MajorMap >**  
  
| 단과대학 | 전공명             |
|:----:|:---------------:|
| 의과대학 | 간호학과, 의예과       |
| 사범대학 | 국어교육과, 지리교육과, … |  
 
- **정규화**  
**< MajorMap >**  
  
| 단과대학 | 전공명   |
|:----:|:-----:|
| 의과대학 | 간호학과  |
| 의과대학 | 의예과   |
| 사범대학 | 국어교육과 |
| 사범대학 | 지리교육과 |
| 사범대학 |  …    |  

<br>

**제 2 정규화**(2NF)  
> 제 1정규화를 진행한 테이블에 대해 부분 함수 종속을 제거하여 **완전 함수 종속**을 만들도록 테이블을 분해  

**완전 함수 종속이란**, 기본키를 구성하는 모든 컬럼의 값이 다른 컬럼을 결정짓는 상태  
즉, 기본기(Primary Key, PK)가 2개 이상일 때 발생하며, 기본키의 일부와 종속되는 관계가 있다면 분리한다.  

- **기존**  
**< 수강이력 >** PK : (학생번호 + 강의명)  
  
| 학생번호 | 강의명    | 강의실 | 성적  |
|:----:|:------:|:---:|:---:|
| 1000 | 컴퓨터공학  | 자연관 | A   |
| 1001 | 컴퓨터공학  | 자연관 | C   |
| 1002 | 기초통계   | 본관  | A+  |
| 1000 | 데이터베이스 | 자연관 | B+  |
| 1001 | 경영학    | 본관  | C   |  

- **정규화**  
**< 수강이력 >**  

| 학생번호 | 강의명    | 성적  |
|:----:|:------:|:---:|
| 1000 | 컴퓨터공학  | A   |
| 1001 | 컴퓨터공학  | C   |
| 1002 | 기초통계   | A+  |
| 1000 | 데이터베이스 | B+  |
| 1001 | 경영학    | C   |  

**< 강의실 >**  

| 강의명    | 강의실 |
|:------:|:---:|
| 컴퓨터공학  | 자연관 |
| 기초통계   | 본관  |
| 데이터베이스 | 자연관 |
| 경영학    | 본관  |  

<br>

**제 3 정규화**(3NF)  
> 제 2정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분리  

**이행적 종속이란**, A -> B, B -> C 의 관계가 성립할 때, A -> C 관계가 성립되는 경우를 뜻한다.  
(A, B), (B, C) 로 분리하는 것이 제 3정규화이다.  

- **기존**  
**< 구매 >**   

| 고객 번호 | 상품명 | 가격   |
|:-----:|:---:|:----:|
| 1     | 우유  | 2500 |
| 2     | 치즈  | 3500 |
| 3     | 소시지 | 4000 |
| 4     | 우유  | 2500 |


- **정규화**  
**< 구매 >**  

| 고객 번호 | 상품명 |
|:-----:|:---:|
| 1     | 우유  |
| 2     | 치즈  |
| 3     | 소시지 |
| 4     | 우유  |

**< 상품 >**  

| 상품명 | 가격   |
|:---:|:----:|
| 우유  | 2500 |
| 치즈  | 3500 |
| 소시지 | 4000 |
| 우유  | 2500 |

<br>

**BCNF 정규화**(Boyce-Codd Normal Form)  
- 모든 결정자가 후보키가 되도록 테이블을 분해하는 것  

<br>

**제 4 정규화**(4NF)  
- 여러 컬럼들이 하나의 컬럼을 종속시키는 경우 분해하여 다중값 종속성을 제거  

<br>

**제 5 정규화**(5NF)
- 조인에 의해 종속이 발생되는 경우 분해
